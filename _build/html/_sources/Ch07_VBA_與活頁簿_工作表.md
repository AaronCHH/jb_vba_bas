# Ch07 VBA 與活頁簿 工作表
## 07章-1
## 範例1 建立新的活頁簿
```
'-------------------
'範例1 建立新的活頁簿
'-------------------

Sub 新增活頁簿()
    Workbooks.Add
End Sub
```
## 範例2 開啟指定資料夾中的活頁簿
```
'---------------------------------------------
'範例2 開啟指定資料夾中的活頁簿
'
'(請任意變更磁碟代號來執行)
'---------------------------------------------

Sub 開啟活頁簿()
    Workbooks.Open Filename:="C:\Excel2003VBA基礎篇\Dummy.xls"
End Sub
```
## 範例3 從預設資料夾中開啟活頁簿
```
'----------------------------------------------------------------------------------------------
'範例3 從預設資料夾中開啟活頁簿
'
'(請將「Excel2003基礎篇」資料夾設定為預設資料夾來執行)
'----------------------------------------------------------------------------------------------

Sub 開啟活頁簿2()
    Workbooks.Open Filename:="Dummy.xls"
End Sub

```
## 範例4 關閉所有活頁簿
```
'-------------------
'範例4 關閉所有活頁簿
'-------------------

Sub 關閉活頁簿()
    Workbooks.Close
End Sub

```
## 範例5 關閉使用中的活頁簿
```
'-----------------------
'範例5 關閉使用中的活頁簿
'-----------------------

Sub 關閉活頁簿2()
    ActiveWorkbook.Close
End Sub

```
## 範例6 關閉特定的活頁簿
```
'--------------------------------------------
'範例6 關閉特定的活頁簿
'
'(請開啟「Dummy.xls」後再執行)?????
'---------------------------------------------

Sub 關閉活頁簿3()
    Workbooks("Dummy.xls").Close
End Sub

```
## 範例7 關閉第幾個活頁簿
```
'-----------------------------------------
'範例7 關閉第幾個活頁簿
'
'(請開啟兩個以上的活頁簿來執行)
'-----------------------------------------

Sub 關閉活頁簿4()
    Workbooks(2).Close
End Sub

Attribute VB_Name = "Module2"

```
## 範例8 將活頁簿存檔後關閉
```
'------------------------------------------
'範例8 將活頁簿存檔後關閉
'
'(請開啟「Dummy.xls」後再執行)
'------------------------------------------

Sub 關閉活頁簿5()
    Workbooks("Dummy.xls").Close SaveChanges:=True '指定引數的名稱
End Sub

```
## 範例9 活頁簿關閉時不存檔
```
'------------------------------------------
'範例9 活頁簿關閉時不存檔
'
'(請開啟「Dummy.xls」後再執行)
'------------------------------------------

Sub 關閉活頁簿6()
    Workbooks("Dummy.xls").Close False              '標準引數
End Sub

```
## 範例10 指定使用中的活頁簿
```
'------------------------------------------
'範例10 指定使用中的活頁簿
'
'(請開啟「Dummy.xls」後再執行)
'------------------------------------------

Sub 指定活頁簿()
Attribute 指定活頁簿.VB_ProcData.VB_Invoke_Func = " \n14"
    Workbooks("Dummy.xls").Activate
End Sub

```
## 範例11 將活頁簿存檔
```
'----------------------------------
'範例11 將活頁簿存檔
'
'----------------------------------
 
Sub 活頁簿存檔()
    ActiveWorkbook.Save             '儲存使用中活頁簿
End Sub

Sub 活頁簿存檔2()
    Workbooks("Dummy.xls").Save    '指定存檔名稱後儲存
End Sub

```
## 範例12 儲存活頁簿時另存新檔
```
'--------------------------------------------
'範例12 儲存活頁簿時另存新檔
'
'---------------------------------------------

Sub 儲存活頁簿3()
Attribute 儲存活頁簿3.VB_ProcData.VB_Invoke_Func = " \n14"
    '指定儲存目標
    ActiveWorkbook.SaveAs Filename:="C:\Excel2003VBA基礎篇\Test.xls"
End Sub

Sub 儲存活頁簿4()
Attribute 儲存活頁簿4.VB_ProcData.VB_Invoke_Func = " \n14"
    '存放到目前資料夾中
    ActiveWorkbook.SaveAs Filename:="Test.xls"
End Sub
```

## 07章-2

## 範例13 插入新的工作表
```
'-------------------------
'範例13 插入新的工作表
'-------------------------

Sub 插入工作表()
    Worksheets.Add
End Sub

```
## 範例14 指定插入位及數量
```
'-------------------------------------------
'範例14 指定插入位及數量
'-------------------------------------------

Sub 插入工作表2()
    Worksheets.Add After:=Worksheets(1), Count:=2
End Sub

```
## 範例15 指定使用中工作表
```
'----------------------------
'範例15 指定使用中工作表
'----------------------------

Sub 指定工作表()
    Worksheets("Sheet3").Activate
End Sub

Sub 指定工作表2()
    Worksheets("Sheet3").Select
End Sub

```
## 範例16 選取多個工作表
```
'----------------------------------------
'範例16 選取多個工作表
'----------------------------------------
  
Sub 選取多個工作表()
    Worksheets.Select               '選取全部工作表
End Sub

Sub 選取多個工作表2()
    Worksheets(Array(1, 3)).Select  '選取第1、3個工作表
End Sub

```
## 範例17 在同一個活頁簿中移動工作表
```
'----------------------------------
'範例17 在同一個活頁簿中移動工作表
'----------------------------------

Sub 移動工作表1()
    Worksheets("Sheet1").Move After:=Worksheets("Sheet3")
End Sub

```
## 範例18 將工作表移到其他活頁簿中
```
'-----------------------------------------
'範例18 將工作表移到其他活頁簿中
'
'(請開啟「Dummy.xls」後再執行)
'-----------------------------------------

Sub 移動工作表2()
    Worksheets("Sheet4").Move _
        Before:=Workbooks("Dummy.xls").Sheets(2)
End Sub

```
## 範例19 將工作表移到新建的活頁簿中
```
'----------------------------------
'範例19 將工作表移到新建的活頁簿中
'----------------------------------

Sub 移動工作表3()
    Worksheets("Sheet5").Move
End Sub

```
## 範例20 在同一個活頁簿中複製工作表
```
'-----------------------
'範例20 在同一個活頁簿中複製工作表
'-----------------------
  
Sub 複製工作表()
    '在同一個活頁簿中複製工作表
    Worksheets("Sheet1").Copy After:=Worksheets("Sheet3")

    '將工作表複製到其他的活頁簿中
    'Worksheets("Sheet1").Copy Before:=Workbooks("Dummy.xls").Sheets(2)

    '將工作表複製到新建的活頁簿中
    'Worksheets("Sheet1").Copy
End Sub


```
## 範例21 刪除工作表
```
'---------------------
'範例21 刪除工作表
'---------------------

Sub 刪除工作表()
    Application.DisplayAlerts = False
    Worksheets("Sheet6").Delete
    Application.DisplayAlerts = True
End Sub

Sub 刪除工作表2()
    Dim myChart As Chart
    
    '刪除所有圖表工作表
    For Each myChart In Charts
        myChart.Delete
    Next
End Sub

```
## 範例22 隱藏工作表
```
'------------------------
'範例22 隱藏工作表
'------------------------

Sub 隱藏工作表()
    Worksheets("Sheet3").Visible = False
End Sub

Sub 隱藏工作表2()
    '不是使用「顯示」指令
    Worksheets("Sheet3").Visible = xlVeryHidden
End Sub

```
## 範例23 顯示工作表
```
'-----------------------
'範例23 顯示工作表
'-----------------------

Sub 顯示工作表()
    Worksheets("Sheet3").Visible = True
End Sub
```

